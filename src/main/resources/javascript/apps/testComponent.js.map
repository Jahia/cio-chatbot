{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/main/javascript/app/DxContext.jsx","webpack:///./src/main/javascript/app/gqlQueries.js","webpack:///./src/main/javascript/app/productbot/App.jsx","webpack:///./src/main/javascript/app/productbot/Conversation.jsx","webpack:///./src/main/javascript/app/productbot/Message.jsx","webpack:///./src/main/javascript/app/productbot/ProductList.jsx","webpack:///./src/main/javascript/app/productbot/main.jsx","webpack:///./src/main/javascript/app/productbot/products.jsx"],"names":["DxContext","React","createContext","gqlQueries","SITE_QUERY","PRODUCT_QUERY","App","props","state","conversationId","profileId","messageObjectList","handleSubmit","bind","handleRestart","window","callWatson","getFavoriteColor","$this","intervalWatson","setInterval","cxs","undefined","clearInterval","startWatson","dxContext","then","responseJson","data","favoriteColor","catch","error","console","log","fetch","servletContext","method","headers","body","JSON","stringify","query","variables","response","ok","reject","json","message","askEmail","sendMessage","date","Date","handleResponse","outputMessage","outputMessages","filter","text","join","outputDate","toLocaleTimeString","outputConversationId","setState","msgObj","position","hasTail","addMessage","canSearch","formatProducts","emailAddress","manageWemPrivacyInstances","Object","keys","updateConsent","digitalData","scope","e","inputMessage","target","value","inputDate","formattedDate","element","document","getElementsByClassName","scrollTop","scrollHeight","scrollToBottom","componentDidMount","Component","Conversation","makeMessage","index","label","isValidElement","onRestart","map","onSubmit","Message","client","link","uri","cache","ProductList","paddingTop","fontSize","productBotComponentReactRender","id","ReactDOM","render","getElementById","Products","grantedConsent","displayModal","consents","length","status","hasGrantedConsent","consentText","shouldDisplayModal","askedForEmailAlready","manageWemPrivacy","privacyHandler","set","obj","prop","oldVal","Proxy","newProps","fetchProducts","loading","prods","products","prodIndex","findIndex","prod","outOfStock","sku","vanityUrl","images","url","name","price","formattedValue","ProductsQuery","graphql","options","withApollo"],"mappings":"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","file":"testComponent.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"testComponent\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"vendors-chatbot\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import React from 'react';\n\nconst DxContext = React.createContext();\n\nexport {DxContext};","import gql from 'graphql-tag';\n\nconst gqlQueries = {\n    SITE_QUERY: gql`query Sites($path: String!){\n        jcr {\n            nodeByPath(path: $path) {\n              displayName  \n              name\n              path\n              children {\n                nodes {\n                  displayName\n                  name\n                }\n              }\n            }\n          }\n    }`\n\t\n/* \t,Watson_QUERY: gql`query watson($message: String!,$conversationId : String){\n\t\tsendMessage(message:$message, conversationId:$conversationId){\n\t\t\tconversationId\n\t\t\tentities\n\t\t\tintents\n\t\t\toutputMessages\n\t\t}\n\t}` */\n\n\t,PRODUCT_QUERY: gql`query productList($conversationId : String!, $profileId : String) {\n\t\t  products(conversationId : $conversationId, limit:9, offset:0, profileId : $profileId ) {\n\t\t\tsku\n\t\t\tname\n\t\t\tmountedPath\n\t\t\tvanityUrl\n\t\t\tcode\n\t\t\toutOfStock\n\t\t\timages {\n\t\t\t  altText\n\t\t\t  format\n\t\t\t  imageType\n\t\t\t  url\n\t\t\t}\n\t\t\tprice{\n\t\t\t\tformattedValue\n\t\t\t}\n\t\t}\n\t}`\t\n};\n\nexport default gqlQueries;","import React from 'react';\nimport Conversation from './Conversation.jsx';\nimport ProductList from './ProductList.jsx';\nimport _ from 'lodash';\n\nclass App extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            conversationId   : null,\n            profileId        : null,\n            // A Message Object consists of a message[, intent, date, isUser]\n            messageObjectList: []\n        };\n\n        this.handleSubmit  = this.handleSubmit.bind(this);\n        this.handleRestart = this.handleRestart.bind(this);\n        window.callWatson = this.callWatson.bind(this);\n        window.getFavoriteColor = this.getFavoriteColor.bind(this);\n    }\n\n    componentDidMount() {\n        // Todo: Call grapqhql entry point for favoriteColor (when window.cxs (CDP profile) is available). This will give context for the style.\n        var $this          = this;\n        var intervalWatson = setInterval(function () {\n            if (window.cxs !== undefined) {\n                clearInterval(intervalWatson);\n                $this.startWatson();\n            }\n        }, 100);\n\n    }\n\n    startWatson() {\n        if (window.cxs !== undefined && window.cxs.profileId !== undefined) {\n            this.props.dxContext.profileId = window.cxs.profileId;\n\n            this.getFavoriteColor(window.cxs.profileId).then((responseJson) => {\n                this.callWatson('hello', responseJson.data.favoriteColor, false);\n            }).catch(function (error) {\n                throw error;\n            });\n\n        }\n    }\n\n    getFavoriteColor(profileId) {\n        console.log(profileId);\n        return fetch(this.props.dxContext.servletContext + '/modules/graphql',\n            {\n                method : 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body   : JSON.stringify({\n                        query    : `query ($profileId: String!){\n\t\t\t\t\t\t\tfavoriteColor(profileId:$profileId)\t\n\t\t\t\t\t\t}`,\n                        variables: {\n                            profileId: profileId\n                        }\n                    }\n                )\n            }).then((response) => {\n            console.log(response);\n            if (!response.ok) {\n                return reject(response);\n            }\n\n            return response.json();\n        });\n    }\n\n    callWatson(message, favoriteColor, askEmail) {\n        console.log(\"Calling watson\", askEmail, message, favoriteColor);\n        fetch(this.props.dxContext.servletContext + '/modules/graphql',\n            {\n                method : 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body   : JSON.stringify({\n                        query    : `query ($message: String!,$conversationId : String,$favoriteColor : String, $askEmail : String){\n                            sendMessage(message:$message, conversationId:$conversationId,favoriteColor:$favoriteColor, askEmail:$askEmail){\n                                conversationId\n                                entities{\n                                    name\n                                    value\n                                    confidence\n                                }\n                                intents\n                                outputMessages\n                                canSearch\n                                emailAddress\n                            }\n                        }`,\n                        variables: {\n                            message       : message,\n                            conversationId: this.state.conversationId,\n                            favoriteColor : favoriteColor,\n                            askEmail      : (askEmail !== undefined && askEmail) ? \"true\":\"false\"\n                        }\n                    }\n                )\n            }).then((response) => {\n            if (!response.ok) {\n                return reject(response);\n            }\n\n            return response.json();\n        }).then((responseJson) => {\n\n            responseJson.data.sendMessage.date = new Date();\n            this.handleResponse(responseJson.data.sendMessage);\n        }).catch(function (error) {\n            throw error;\n        });\n    }\n\n    handleResponse(responseJson) {\n        const outputMessage = responseJson.outputMessages.filter(text => text).join('\\n');\n        /*        const outputIntent         = responseJson.intents[0]; */\n        const outputDate           = responseJson.date.toLocaleTimeString();\n        const outputConversationId = responseJson.conversationId;\n        this.setState({\n            conversationId: outputConversationId\n        });\n        const msgObj = {\n            position: 'left',\n            /*             label   : outputIntent, */\n            message : outputMessage,\n            date    : outputDate,\n            hasTail : true\n        };\n        this.addMessage(msgObj);\n        if (responseJson.canSearch) {\n            this.formatProducts(outputConversationId);\n        }\n        if (responseJson.emailAddress !== null) {\n            console.log(\"User gave is consent updating CDP\");\n            window.manageWemPrivacyInstances[Object.keys(window.manageWemPrivacyInstances)[0]].updateConsent(digitalData.scope,\"outofstock\",true);\n        }\n    }\n\n    addMessage(msgObj) {\n        this.setState({\n            messageObjectList: [...this.state.messageObjectList, msgObj]\n        });\n    }\n\n    handleSubmit(e) {\n        const inputMessage = e.target.value;\n        if (e.target.value == \"\") {\n            return;\n        }\n        const inputDate     = new Date();\n        const formattedDate = inputDate.toLocaleTimeString();\n        const msgObj        = {\n            position: 'right',\n            message : inputMessage,\n            date    : formattedDate,\n            hasTail : true\n        };\n        this.addMessage(msgObj);\n        e.target.value = '';\n        this.callWatson(inputMessage);\n    }\n\n    scrollToBottom() {\n        const element     = document.getElementsByClassName('conversation__messages')[0];\n        element.scrollTop = element.scrollHeight;\n    }\n\n    componentDidUpdate() {\n        this.scrollToBottom();\n    }\n\n    formatProducts(conversationId) {\n        console.log(\"rendering products\", this.state.messageObjectList);\n\n        this.setState({\n            conversationId   : conversationId,\n            profileId        : (!_.isUndefined(window.cxs) ? window.cxs.profileId : null),\n            messageObjectList: this.state.messageObjectList\n        });\n    }\n\n    handleRestart() {\n        this.setState({\n            conversationId   : null,\n            profileId        : null,\n            // A Message Object consists of a message[, intent, date, isUser]\n            messageObjectList: []\n        }, function () {\n            this.componentDidMount();\n        });\n    }\n\n    render() {\n        return (\n            <div className=\"app-wrapper\">\n                    <Conversation\n                        onSubmit={this.handleSubmit}\n                        onRestart={this.handleRestart}\n                        messageObjectList={this.state.messageObjectList}\n                    />\n                    <div className=\"watson_result\">\n                        <ProductList dxContext={this.props.dxContext}\n                                     conversationId={this.state.conversationId}\n                                     profileId={this.state.profileId}/>\n                    </div>\n            </div>\n        );\n    }\n}\n\nexport default App;\n","import React from 'react';\nimport { InputWithButton } from 'watson-react-components';\nimport Message from './Message.jsx';\n\nfunction Conversation(props) {\n\n  function makeMessage(msgObj, index) {\n\n    if (typeof msgObj.message === 'string') {\n      return (\n        <Message key={index} position={msgObj.position || false} label={msgObj.label || false} date={msgObj.date || false} message={msgObj.message} hasTail={msgObj.hasTail || false}/>\n      );\n    } else if ( React.isValidElement(msgObj.message)) {\n      return ( msgObj.message );\n    } else {\n      return false;\n    }\n  }\n\n  return (\n    <div className=\"conversation\">\n        <div className=\"conversation__disclaimer--message\">\n            <i className=\"fas fa-comments\"></i>\n            <button onClick={props.onRestart} ><i className=\"fas fa-sync-alt\"></i></button>\n        </div>\n\n      <div className=\"conversation__messages\">\n        <div>\n          {props.messageObjectList.map(makeMessage)}\n        </div>\n      </div>\n\n        <div className=\"conversation__input-container\">\n          <InputWithButton className=\"conversation__input\" onSubmit={props.onSubmit} placeholder=\"Say something to Watson.\"/>\n        </div>\n\n    </div>\n  );\n}\n\nexport default Conversation;\n","import React from 'react';\n\nfunction Message(props) {\n  return (\n    <div className={props.position === 'right' ? 'message message--from-right' : 'message message--from-left'}>\n      {props.label ? <div className=\"message__label\">{props.label}</div> : false}\n      <div className=\"message__content\">{props.message}</div>\n      {props.hasTail ? (\n        <div className=\"message__tail\">\n          <div className=\"message__tail-background\"></div>\n          <div className=\"message__tail-foreground\"></div>\n        </div>\n      ) : false}\n      {props.date ? <div className=\"message__date\">{props.date}</div> : false}\n    </div>\n  );\n}\n\nexport default Message;\n","import React from \"react\";\nimport {ApolloProvider} from 'react-apollo';\nimport {DxContext} from \"../DxContext.jsx\";\nimport Products from './products.jsx';\nimport {ApolloClient} from \"apollo-client\";\nimport {HttpLink} from \"apollo-link-http\";\nimport {InMemoryCache} from \"apollo-cache-inmemory\";\nimport {ConversationContext} from \"./App\";\nimport _ from \"lodash\";\n\nconst client = (props => {\n    const link = new HttpLink({\n        uri: props.dxContext.servletContext + '/modules/graphql'\n    });\n\n    return new ApolloClient({\n        link : link,\n        cache: new InMemoryCache()\n    });\n});\n\nclass ProductList extends React.Component {\n\n    render() {\n\n        let {dxContext, conversationId, profileId} = this.props;\n        return (<ApolloProvider client={client(this.props)}>\n            <DxContext.Provider value={dxContext}>\n                { _.isNil(conversationId) || _.isNil(profileId) ?\n                    (<span style={{paddingTop: 35, fontSize: 69}}><i className=\"fas fa-box\"></i></span>)\n                    :\n                    (<Products dxContext={dxContext}\n                                                    conversationId={conversationId}\n                                                    profileId={profileId}/>\n                    )\n                }\n\n            </DxContext.Provider>\n        </ApolloProvider>)\n    }\n\n}\n\nexport default ProductList;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App.jsx';\n\nwindow.productBotComponentReactRender = function(target, id, dxContext) {\n    ReactDOM.render(<App id={id} dxContext={dxContext}/>, document.getElementById(target));\n};","import React from \"react\";\nimport gqlQueries from \"../gqlQueries\";\nimport {graphql} from \"react-apollo/index\";\nimport {withApollo} from \"react-apollo\";\nimport {Col, Grid, Row} from 'react-bootstrap';\n\nclass Products extends React.Component {\n\n    constructor(props) {\n        super(props);\n        let grantedConsent = false;\n        let displayModal   = false;\n        if (window.cxs !== undefined && window.cxs.consents !== undefined) {\n            const consents = window.cxs.consents;\n            let keys       = Object.keys(consents);\n            if (keys.length > 0) {\n                if (consents[\"apparel-uk/outofstock\"] !== undefined) {\n                    // Check if consent is granted or not\n                    grantedConsent = (consents[\"apparel-uk/outofstock\"].status === \"GRANTED\");\n                } else {\n                    displayModal = true;\n                }\n            } else {\n                displayModal = true;\n            }\n        }\n        this.state = {\n            hasGrantedConsent : grantedConsent,\n            consentText       : (grantedConsent ? \"You have consented to the usage of your email to receive information about product out of stock.\" : \"You have not consented to the usage of your email to receive information about product out of stock.\"),\n            shouldDisplayModal: displayModal,\n            askedForEmailAlready: false\n        };\n        var $this  = this;\n        if (window.manageWemPrivacy !== undefined) {\n            let privacyHandler      = {\n                set: function (obj, prop, value) {\n                    console.log(\"calling proxy setter\", prop, value);\n                    let oldVal = obj[prop];\n                    if (prop === \"modelAlreadyOpen\" && value !== oldVal) {\n                        if (window.cxs !== undefined && window.cxs.consents !== undefined) {\n                            const consents = window.cxs.consents;\n                            let keys       = Object.keys(consents);\n                            if (keys.length > 0) {\n                                if (consents[\"apparel-uk/outofstock\"] !== undefined) {\n                                    // Check if consent is granted or not\n                                    let consentText = \"You have not consented to the usage of your email to receive information about product out of stock.\";\n                                    if (consents[\"apparel-uk/outofstock\"].status === \"GRANTED\") {\n                                        consentText = \"You have consented to the usage of your email to receive information about product out of stock.\";\n                                    }\n                                    $this.setState({\n                                        hasGrantedConsent : consents[\"apparel-uk/outofstock\"].status === \"GRANTED\",\n                                        consentText       : consentText,\n                                        shouldDisplayModal: false\n                                    })\n                                }\n                            }\n                        }\n                    }\n                    obj[prop] = value;\n                }\n            };\n            window.manageWemPrivacy = new Proxy(window.manageWemPrivacy, privacyHandler);\n        }\n    }\n\n    componentWillReceiveProps(newProps) {\n        if (!newProps.fetchProducts.loading) {\n            const prods = newProps.fetchProducts.products ? newProps.fetchProducts.products : [];\n            const prodIndex = prods.findIndex(function(prod){\n                return prod.outOfStock;\n            });\n            if(prodIndex > -1 && !this.state.askedForEmailAlready) {\n                window.getFavoriteColor(window.cxs.profileId).then((responseJson) => {\n                    console.log(prods[prodIndex]);\n                    if(responseJson.data.favoriteColor !== null) {\n                        console.log(\"fav col:\"+responseJson.data.favoriteColor);\n                        this.setState({\n                            askedForEmailAlready: true\n                        });\n                        window.callWatson(\"Asking for your consent\", responseJson.data.favoriteColor, true);\n                    }\n                }).catch(function (error) {\n                    console.log(error);\n                });\n            }\n        }\n    }\n\n    render() {\n\n        if (this.props.fetchProducts.error) {\n            return this.props.fetchProducts.error.message;\n        }\n\n        const prods = this.props.fetchProducts.products ? this.props.fetchProducts.products : [];\n\n        // if (this.state.shouldDisplayModal && window.manageWemPrivacyInstances !== undefined) {\n        //     let privacyInstance          = window.manageWemPrivacyInstances[Object.keys(window.manageWemPrivacyInstances)[0]];\n        //     privacyInstance.captiveModal = true;\n        //     privacyInstance.openModal(true);\n        // }\n\n        return <Grid className=\"product-container\" fluid={true}>\n            <Row className=\"product-row\">\n                <Col xs={12} md={12} lg={12}>\n                    <div\n                        className={this.state.hasGrantedConsent ? \"alert alert-success\" : \"alert alert-warning\"}>\n                        {this.state.consentText}\n                        </div>\n                </Col>\n            </Row>\n            <Row className=\"product-row\">\n                {\n                    prods.map((prod) => (\n                        <Col xs={6} md={4} lg={4} key={prod.sku}>\n\t\t\t\t\t\t<a href={\"https://demo.commerceio.jahia.com\" + prod.vanityUrl} target=\"_blank\"> \n                            <div className=\"product-card\">\n                                <div className=\"product\">\n                                    <Row className=\"product-row product-header\">\n                                        <Col xs={12} className=\"product-match-high\">High\n                                            Match</Col>\n                                    </Row>\n                                    <Row className=\"product-row\">\n                                        <Col xs={12} className=\"product-img-wrapper\">\n                                            <img className=\"product-img\"\n                                                 src={\"https://demo.commerceio.jahia.com\" + prod.images[1].url}/>\n                                        </Col>\n                                    </Row>\n                                    <Row className=\"product-row\">\n                                        <div className=\"product-name-wrapper\">\n                                            <Col xs={12} className=\"product-name\">\n                                                <span>{prod.name} {prod.outOfStock ? \"Out Of Stock\" : \"\"}</span>\n                                            </Col>\n                                            <Col xs={12} className=\"product-price\">\n                                                <span>{prod.price.formattedValue}</span>\n                                            </Col>\n                                        </div>\n                                    </Row>\n                                </div>\n                            </div>\n\t\t\t\t\t\t</a>\n                        </Col>\n                    ))\n                }\n            </Row>\n        </Grid>\n    }\n}\n\nconst ProductsQuery = graphql(gqlQueries.PRODUCT_QUERY, {\n    name: 'fetchProducts',\n    options(props) {\n        return {\n            variables: {\n                \"conversationId\": props.conversationId,\n                \"profileId\"     : props.profileId\n            }\n        }\n    }\n});\n\nexport default withApollo(ProductsQuery(Products));"],"sourceRoot":""}